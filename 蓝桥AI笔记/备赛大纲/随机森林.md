## 随机森林

```
from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import RandomizedSearchCV
import numpy as np

# 加载鸢尾花数据集
iris = load_iris()

# 只取前两个特征
X = iris.data[:, :2]

# 目标变量
y = iris.target 
X_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.2,random_state = 42)

params = {

'n_estimators': [10, 50, 100, 200, 500], # 决策树的数量

'max_depth': np.arange(3, 11), # 决策树的最大深度范围

'max_samples': np.arange(0.5, 1.0, 0.1), # 每棵决策树的样本比例范围

'max_features': ['sqrt', 'log2', None] # 每棵决策树的特征选择方式

}

search = RandomizedSearchCV(RandomForestClassifier(random_state=42), params, n_iter=50, cv=3, n_jobs=-1) # 随机搜索交叉验证

search.fit(X_train, y_train) # 拟合训练数据

  
  

print(search.best_params_) # 输出最佳参数

  

# 将最佳分类器赋值给best_clf变量

best_clf = search.best_estimator_

# 输出训练集上的准确率

print(f'Train accuracy: {best_clf.score(X_train, y_train):.4f}')

  

# 输出测试集上的准确率

print(f'Test accuracy: {best_clf.score(X_test, y_test):.4f}')
```


<!--stackedit_data:
eyJoaXN0b3J5IjpbNjgxODM1MDUxXX0=
-->